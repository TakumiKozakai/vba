Sub createSQL()    Dim currentCell As Range    Dim srcSheet As Worksheet    Set srcSheet = ActiveSheet    Dim targetRange As Range    Set targetRange = srcSheet.UsedRange    Dim tableName As Range    Set tableName = Range("B1")    'DELETE文作成    Dim deleteSql As String    deleteSql = "DELETE FROM " & tableName.Value & ";"    'INSERT文前半作成    Dim insertSql As String    insertSql = "INSERT INTO " & tableName.Value & "("    'SELECT文作成    Dim selectSql As String    selectSql = "SELECT * FROM " & tableName.Value & ";"    Dim currentColumnIndex As Integer    Dim currentRowIndex As Integer    currentRowIndex = targetRange.Row + 1    '列だけ繰り返す    For currentColumnIndex = targetRange.Column To targetRange.Columns.Count        '最初でなければ        If (currentColumnIndex <> targetRange.Column) Then            insertSql = insertSql & ", "        End If        'セルを指定        Set currentCell = srcSheet.Cells(currentRowIndex, currentColumnIndex)        insertSql = insertSql & currentCell.Value    Next    insertSql = insertSql & ") VALUES "    'INSERT文のVALUES以降を作成    '行だけ繰り返す    For currentRowIndex = targetRange.Row + 2 To targetRange.Rows.Count        insertSql = insertSql & "("        '列だけ繰り返す        For currentColumnIndex = targetRange.Column To targetRange.Columns.Count            '最初でなければ            If (currentColumnIndex <> targetRange.Column) Then                insertSql = insertSql & ", "            End If            'セルを設定            Set currentCell = srcSheet.Cells(currentRowIndex, currentColumnIndex)            'nullか空文字なら            If IsNull(currentCell) Or currentCell.Value = "" Then                insertSql = insertSql & "null"                        '数値なら            ElseIf IsNumeric(currentCell.Value) And Left(currentCell.Value, 1) <> 0 Then                insertSql = insertSql & currentCell.Value                        'それ以外なら            Else                insertSql = insertSql & "'" & currentCell.Value & "'"            End If                Next        '最終行なら        If (currentRowIndex = targetRange.Rows.Count) Then            insertSql = insertSql & ");"                'それ以外なら        Else            insertSql = insertSql & "), "        End If        Next    'シートにDELETE文を出力    srcSheet.Cells(currentRowIndex + 1, 1).Value = deleteSql    'シートにINSERT文を出力    srcSheet.Cells(currentRowIndex + 2, 1).Value = insertSql    'シートにSELECT文を出力    srcSheet.Cells(currentRowIndex + 3, 1).Value = selectSqlEnd Sub